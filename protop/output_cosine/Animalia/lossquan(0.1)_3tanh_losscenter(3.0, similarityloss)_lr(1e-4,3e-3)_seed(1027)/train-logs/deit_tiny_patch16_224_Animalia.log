2024-04-28 08:08:06,734 - main - INFO - Start running with args: 
Namespace(batch_size=128, distillw=0.5, enable_smoothing=False, enable_mixup=False, w_dis_token=False, base_architecture='deit_base_patch16_224', img_size=224, prototype_shape=[195, 768, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', baseline_path=None, reserve_layers=[11], reserve_token_nums=[196], use_global=True, use_ppc_loss=False, ppc_cov_thresh=1.0, ppc_mean_thresh=2.0, global_coe=0.5, global_proto_per_class=5, ppc_cov_coe=0.1, ppc_mean_coe=0.5, data_path='datasets', features_lr=0.0001, add_on_layers_lr=0.001, prototype_vectors_lr=0.001, joint_lr_step_size=5, coefs_crs_ent=1, coefs_clst=0.8, coefs_sep=-0.08, coefs_l1=0.0001, epochs=200, model='deit_tiny_patch16_224', input_size=224, save_ep_freq=400, drop=0.0, drop_path=0.1, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=0.0005, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10.0, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.4, aa='rand-m9-mstd0.5-inc1', smoothing=0.0, train_interpolation='bicubic', reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.0, cutmix=1.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', finetune='protopformer', data_set='Animalia', inat_category='name', output_dir='output_cosine//Animalia/lossquan(0.1)_3tanh_losscenter(3.0, similarityloss)_lr(1e-4,3e-3)_seed(1027)', device='cuda', seed=1027, resume='', start_epoch=0, eval=False, dist_eval=False, num_workers=10, pin_mem=True, world_size=1, dist_url='env://', distributed=False)
2024-04-28 08:08:06,734 - main - INFO - Distributed: False
2024-04-28 08:08:10,354 - main - INFO - Dataset num_classes: 39
2024-04-28 08:08:10,354 - main - INFO - train 1492 test: 2985
2024-04-28 08:08:10,354 - main - INFO - test_dataset_unlabelled: 5098
2024-04-28 08:08:10,357 - main - INFO - Label smoothing is not enabled, smoothing rate: 0.0
2024-04-28 08:08:10,357 - main - INFO - Mixup is not enabled
2024-04-28 08:08:18,370 - main - INFO - number of params: 14277400
2024-04-28 08:08:18,372 - main - INFO - Start training for 200 epochs
2024-04-28 08:08:18,372 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:08:25,165 - log_every - INFO - Epoch: [0]  [ 0/12]  eta: 0:01:21  lr: 0.000100  loss_protop: 3.6616 (3.6616)  loss_centers: 3.7358 (3.7358)  loss_diff: 0.0277 (0.0277)  loss_quan: 0.5752 (0.5752)  loss_quan2: 0.8281 (0.8281)  time: 6.7915  data: 6.4982  max mem: 2321
2024-04-28 08:08:29,721 - log_every - INFO - Epoch: [0]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.6566 (3.6566)  loss_centers: 3.1016 (3.2603)  loss_diff: 0.3487 (0.2857)  loss_quan: 0.4043 (0.4398)  loss_quan2: 0.6953 (0.7224)  time: 0.9455  data: 0.7626  max mem: 2481
2024-04-28 08:08:30,054 - log_every - INFO - Epoch: [0] Total time: 0:00:11 (0.9734 s / it)
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 0: 0
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 1: 2
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 2: 11
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 3: 40
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 4: 88
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 5: 141
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 6: 155
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 7: 139
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 8: 99
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 9: 50
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 10: 14
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 11: 2
2024-04-28 08:08:30,086 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:08:30,086 - evaluate - INFO - Start validation
2024-04-28 08:08:38,603 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:16  acc1_protop: 16.1458 (16.1458)  local_acc1: 16.1458 (16.1458)  time: 8.5150  data: 8.1786  max mem: 2481
2024-04-28 08:08:43,683 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 7.2917 (8.8068)  local_acc1: 7.2917 (8.8068)  time: 1.2351  data: 1.0182  max mem: 2481
2024-04-28 08:08:45,116 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 5.2083 (7.7052)  local_acc1: 5.2083 (7.7052)  time: 0.9386  data: 0.7353  max mem: 2481
2024-04-28 08:08:45,474 - log_every - INFO - Test: Total time: 0:00:15 (0.9617 s / it)
2024-04-28 08:08:45,550 - evaluate - INFO - len(list(set(preds))): 665 len(preds): 2985
2024-04-28 08:08:45,550 - evaluate - INFO - hash Acc: 0.220
2024-04-28 08:08:45,550 - evaluate - INFO - * Acc1_protop 7.705
2024-04-28 08:09:13,624 - evaluate - INFO - test len(list(set(preds))): 1036 len(preds): 5098
2024-04-28 08:09:13,624 - evaluate - INFO - test hash all_acc: 0.163 old_acc: 0.203 new_acc: 0.146
2024-04-28 08:09:15,073 - evaluate - INFO - test len(list(set(preds1))): 395 len(preds): 5098
2024-04-28 08:09:15,073 - evaluate - INFO - case 1 all_acc: 0.192 old_acc: 0.267 new_acc: 0.161
2024-04-28 08:09:15,079 - evaluate - INFO - case 1 V1_all_acc: 0.219 V1_old_acc: 0.296 V1_new_acc: 0.188
2024-04-28 08:09:16,507 - evaluate - INFO - test len(list(set(preds1))): 395 len(preds): 5098
2024-04-28 08:09:16,508 - evaluate - INFO - case 2 all_acc: 0.192 old_acc: 0.267 new_acc: 0.161
2024-04-28 08:09:16,514 - evaluate - INFO - case 2 V1_all_acc: 0.219 V1_old_acc: 0.296 V1_new_acc: 0.188
2024-04-28 08:09:16,516 - main - INFO - Averaged stats:
2024-04-28 08:09:16,516 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 3.656625827153524, 'loss_centers': 3.2602685689926147, 'loss_diff': 0.2856904440559447, 'loss_quan': 0.4398193359375, 'loss_quan2': 0.7223714192708334}
2024-04-28 08:09:16,517 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:09:22,789 - log_every - INFO - Epoch: [1]  [ 0/12]  eta: 0:01:15  lr: 0.000100  loss_protop: 3.6490 (3.6490)  loss_centers: 2.8970 (2.8970)  loss_diff: 0.4058 (0.4058)  loss_quan: 0.3396 (0.3396)  loss_quan2: 0.6011 (0.6011)  time: 6.2705  data: 6.0488  max mem: 3301
2024-04-28 08:09:25,434 - log_every - INFO - Epoch: [1]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.6438 (3.6451)  loss_centers: 2.8970 (2.8973)  loss_diff: 0.1574 (0.2162)  loss_quan: 0.3445 (0.3444)  loss_quan2: 0.5806 (0.5837)  time: 0.7404  data: 0.5699  max mem: 3301
2024-04-28 08:09:25,792 - log_every - INFO - Epoch: [1] Total time: 0:00:09 (0.7729 s / it)
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 0: 0
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 1: 0
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 2: 13
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 3: 37
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 4: 83
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 5: 147
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 6: 158
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 7: 141
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 8: 103
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 9: 47
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 10: 10
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 11: 2
2024-04-28 08:09:25,836 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:09:25,836 - evaluate - INFO - Start validation
2024-04-28 08:09:34,921 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:25  acc1_protop: 19.7917 (19.7917)  local_acc1: 19.7917 (19.7917)  time: 9.0834  data: 8.8372  max mem: 3301
2024-04-28 08:09:39,453 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 21.8750 (25.0473)  local_acc1: 21.8750 (25.0473)  time: 1.2376  data: 1.0393  max mem: 3301
2024-04-28 08:09:41,139 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 11.4583 (19.5980)  local_acc1: 11.4583 (19.5980)  time: 0.9561  data: 0.7651  max mem: 3301
2024-04-28 08:09:41,459 - log_every - INFO - Test: Total time: 0:00:15 (0.9764 s / it)
2024-04-28 08:09:41,534 - evaluate - INFO - len(list(set(preds))): 586 len(preds): 2985
2024-04-28 08:09:41,534 - evaluate - INFO - hash Acc: 0.264
2024-04-28 08:09:41,534 - evaluate - INFO - * Acc1_protop 19.598
2024-04-28 08:10:09,500 - evaluate - INFO - test len(list(set(preds))): 997 len(preds): 5098
2024-04-28 08:10:09,501 - evaluate - INFO - test hash all_acc: 0.175 old_acc: 0.240 new_acc: 0.149
2024-04-28 08:10:10,938 - evaluate - INFO - test len(list(set(preds1))): 365 len(preds): 5098
2024-04-28 08:10:10,939 - evaluate - INFO - case 1 all_acc: 0.224 old_acc: 0.329 new_acc: 0.181
2024-04-28 08:10:10,945 - evaluate - INFO - case 1 V1_all_acc: 0.264 V1_old_acc: 0.378 V1_new_acc: 0.217
2024-04-28 08:10:12,393 - evaluate - INFO - test len(list(set(preds1))): 365 len(preds): 5098
2024-04-28 08:10:12,394 - evaluate - INFO - case 2 all_acc: 0.224 old_acc: 0.329 new_acc: 0.181
2024-04-28 08:10:12,399 - evaluate - INFO - case 2 V1_all_acc: 0.264 V1_old_acc: 0.378 V1_new_acc: 0.217
2024-04-28 08:10:12,401 - main - INFO - Averaged stats:
2024-04-28 08:10:12,401 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 3.6450549165407815, 'loss_centers': 2.8973233103752136, 'loss_diff': 0.21619591613610586, 'loss_quan': 0.3444417317708333, 'loss_quan2': 0.5836588541666666}
2024-04-28 08:10:12,402 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:10:18,547 - log_every - INFO - Epoch: [2]  [ 0/12]  eta: 0:01:13  lr: 0.000100  loss_protop: 3.6394 (3.6394)  loss_centers: 2.8400 (2.8400)  loss_diff: 0.1409 (0.1409)  loss_quan: 0.3486 (0.3486)  loss_quan2: 0.5737 (0.5737)  time: 6.1431  data: 5.9211  max mem: 3301
2024-04-28 08:10:21,382 - log_every - INFO - Epoch: [2]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.6271 (3.6261)  loss_centers: 2.8167 (2.8234)  loss_diff: 0.0912 (0.1144)  loss_quan: 0.3369 (0.3378)  loss_quan2: 0.5684 (0.5699)  time: 0.7470  data: 0.5682  max mem: 3301
2024-04-28 08:10:21,675 - log_every - INFO - Epoch: [2] Total time: 0:00:09 (0.7727 s / it)
2024-04-28 08:10:21,706 - hamming_distance_statistics - INFO - Hamming distance 0: 0
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 1: 1
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 2: 14
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 3: 36
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 4: 92
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 5: 143
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 6: 153
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 7: 152
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 8: 98
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 9: 34
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 10: 16
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 11: 2
2024-04-28 08:10:21,707 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:10:21,707 - evaluate - INFO - Start validation
2024-04-28 08:10:29,958 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:11  acc1_protop: 28.6458 (28.6458)  local_acc1: 28.6458 (28.6458)  time: 8.2489  data: 8.0236  max mem: 3301
2024-04-28 08:10:35,474 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 52.0833 (45.2178)  local_acc1: 52.0833 (45.2178)  time: 1.2512  data: 1.0527  max mem: 3301
2024-04-28 08:10:37,072 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 20.8333 (35.9129)  local_acc1: 20.8333 (35.9129)  time: 0.9600  data: 0.7683  max mem: 3301
2024-04-28 08:10:37,451 - log_every - INFO - Test: Total time: 0:00:15 (0.9839 s / it)
2024-04-28 08:10:37,535 - evaluate - INFO - len(list(set(preds))): 650 len(preds): 2985
2024-04-28 08:10:37,535 - evaluate - INFO - hash Acc: 0.306
2024-04-28 08:10:37,536 - evaluate - INFO - * Acc1_protop 35.913
2024-04-28 08:11:05,524 - evaluate - INFO - test len(list(set(preds))): 1160 len(preds): 5098
2024-04-28 08:11:05,525 - evaluate - INFO - test hash all_acc: 0.181 old_acc: 0.256 new_acc: 0.150
2024-04-28 08:11:07,010 - evaluate - INFO - test len(list(set(preds1))): 410 len(preds): 5098
2024-04-28 08:11:07,010 - evaluate - INFO - case 1 all_acc: 0.235 old_acc: 0.383 new_acc: 0.174
2024-04-28 08:11:07,018 - evaluate - INFO - case 1 V1_all_acc: 0.262 V1_old_acc: 0.413 V1_new_acc: 0.200
2024-04-28 08:11:08,407 - evaluate - INFO - test len(list(set(preds1))): 410 len(preds): 5098
2024-04-28 08:11:08,408 - evaluate - INFO - case 2 all_acc: 0.235 old_acc: 0.383 new_acc: 0.174
2024-04-28 08:11:08,414 - evaluate - INFO - case 2 V1_all_acc: 0.262 V1_old_acc: 0.413 V1_new_acc: 0.200
2024-04-28 08:11:08,416 - main - INFO - Averaged stats:
2024-04-28 08:11:08,416 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 3.6260805328687034, 'loss_centers': 2.8233832120895386, 'loss_diff': 0.11442474648356438, 'loss_quan': 0.3377888997395833, 'loss_quan2': 0.5699462890625}
2024-04-28 08:11:08,417 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:11:15,245 - log_every - INFO - Epoch: [3]  [ 0/12]  eta: 0:01:21  lr: 0.000100  loss_protop: 3.6178 (3.6178)  loss_centers: 2.8041 (2.8041)  loss_diff: 0.0641 (0.0641)  loss_quan: 0.3298 (0.3298)  loss_quan2: 0.5747 (0.5747)  time: 6.8273  data: 6.6559  max mem: 3301
2024-04-28 08:11:17,216 - log_every - INFO - Epoch: [3]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.5902 (3.5939)  loss_centers: 2.7809 (2.7768)  loss_diff: 0.0505 (0.0551)  loss_quan: 0.3345 (0.3345)  loss_quan2: 0.5732 (0.5727)  time: 0.7330  data: 0.5684  max mem: 3301
2024-04-28 08:11:17,644 - log_every - INFO - Epoch: [3] Total time: 0:00:09 (0.7689 s / it)
2024-04-28 08:11:17,689 - hamming_distance_statistics - INFO - Hamming distance 0: 0
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 1: 0
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 2: 9
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 3: 43
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 4: 90
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 5: 143
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 6: 165
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 7: 151
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 8: 89
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 9: 42
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 10: 8
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 11: 1
2024-04-28 08:11:17,690 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:11:17,690 - evaluate - INFO - Start validation
2024-04-28 08:11:25,576 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:06  acc1_protop: 25.5208 (25.5208)  local_acc1: 25.5208 (25.5208)  time: 7.8842  data: 7.6823  max mem: 3301
2024-04-28 08:11:30,292 - log_every - INFO - Test:  [10/16]  eta: 0:00:06  acc1_protop: 50.0000 (51.4678)  local_acc1: 50.0000 (51.4678)  time: 1.1453  data: 0.9450  max mem: 3301
2024-04-28 08:11:32,915 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 25.0000 (41.7755)  local_acc1: 25.0000 (41.7755)  time: 0.9513  data: 0.7583  max mem: 3301
2024-04-28 08:11:33,226 - log_every - INFO - Test: Total time: 0:00:15 (0.9709 s / it)
2024-04-28 08:11:33,296 - evaluate - INFO - len(list(set(preds))): 549 len(preds): 2985
2024-04-28 08:11:33,296 - evaluate - INFO - hash Acc: 0.352
2024-04-28 08:11:33,296 - evaluate - INFO - * Acc1_protop 41.776
2024-04-28 08:12:00,084 - evaluate - INFO - test len(list(set(preds))): 1115 len(preds): 5098
2024-04-28 08:12:00,085 - evaluate - INFO - test hash all_acc: 0.210 old_acc: 0.319 new_acc: 0.165
2024-04-28 08:12:01,425 - evaluate - INFO - test len(list(set(preds1))): 403 len(preds): 5098
2024-04-28 08:12:01,425 - evaluate - INFO - case 1 all_acc: 0.276 old_acc: 0.395 new_acc: 0.226
2024-04-28 08:12:01,432 - evaluate - INFO - case 1 V1_all_acc: 0.318 V1_old_acc: 0.470 V1_new_acc: 0.255
2024-04-28 08:12:02,778 - evaluate - INFO - test len(list(set(preds1))): 403 len(preds): 5098
2024-04-28 08:12:02,779 - evaluate - INFO - case 2 all_acc: 0.276 old_acc: 0.395 new_acc: 0.226
2024-04-28 08:12:02,785 - evaluate - INFO - case 2 V1_all_acc: 0.318 V1_old_acc: 0.470 V1_new_acc: 0.255
2024-04-28 08:12:02,787 - main - INFO - Averaged stats:
2024-04-28 08:12:02,787 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 3.593855877717336, 'loss_centers': 2.7767903208732605, 'loss_diff': 0.055121528605620064, 'loss_quan': 0.3344930013020833, 'loss_quan2': 0.5727132161458334}
2024-04-28 08:12:02,788 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:12:08,625 - log_every - INFO - Epoch: [4]  [ 0/12]  eta: 0:01:09  lr: 0.000100  loss_protop: 3.5676 (3.5676)  loss_centers: 2.7475 (2.7475)  loss_diff: 0.0396 (0.0396)  loss_quan: 0.3284 (0.3284)  loss_quan2: 0.5811 (0.5811)  time: 5.8285  data: 5.6136  max mem: 3301
2024-04-28 08:12:11,876 - log_every - INFO - Epoch: [4]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.5442 (3.5476)  loss_centers: 2.7449 (2.7449)  loss_diff: 0.0185 (0.0237)  loss_quan: 0.3164 (0.3169)  loss_quan2: 0.5747 (0.5769)  time: 0.7565  data: 0.5635  max mem: 3301
2024-04-28 08:12:12,275 - log_every - INFO - Epoch: [4] Total time: 0:00:09 (0.7906 s / it)
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 0: 0
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 1: 4
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 2: 16
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 3: 45
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 4: 99
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 5: 145
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 6: 156
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 7: 139
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 8: 90
2024-04-28 08:12:12,308 - hamming_distance_statistics - INFO - Hamming distance 9: 41
2024-04-28 08:12:12,309 - hamming_distance_statistics - INFO - Hamming distance 10: 6
2024-04-28 08:12:12,309 - hamming_distance_statistics - INFO - Hamming distance 11: 0
2024-04-28 08:12:12,309 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:12:12,309 - evaluate - INFO - Start validation
2024-04-28 08:12:20,715 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:14  acc1_protop: 28.6458 (28.6458)  local_acc1: 28.6458 (28.6458)  time: 8.4039  data: 8.2098  max mem: 3301
2024-04-28 08:12:24,994 - log_every - INFO - Test:  [10/16]  eta: 0:00:06  acc1_protop: 57.8125 (57.7652)  local_acc1: 57.8125 (57.7652)  time: 1.1529  data: 0.9561  max mem: 3301
2024-04-28 08:12:28,200 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 28.6458 (45.7621)  local_acc1: 28.6458 (45.7621)  time: 0.9929  data: 0.8024  max mem: 3301
2024-04-28 08:12:28,590 - log_every - INFO - Test: Total time: 0:00:16 (1.0175 s / it)
2024-04-28 08:12:28,661 - evaluate - INFO - len(list(set(preds))): 517 len(preds): 2985
2024-04-28 08:12:28,662 - evaluate - INFO - hash Acc: 0.372
2024-04-28 08:12:28,662 - evaluate - INFO - * Acc1_protop 45.762
2024-04-28 08:12:55,496 - evaluate - INFO - test len(list(set(preds))): 1091 len(preds): 5098
2024-04-28 08:12:55,496 - evaluate - INFO - test hash all_acc: 0.178 old_acc: 0.314 new_acc: 0.122
2024-04-28 08:12:56,814 - evaluate - INFO - test len(list(set(preds1))): 409 len(preds): 5098
2024-04-28 08:12:56,814 - evaluate - INFO - case 1 all_acc: 0.254 old_acc: 0.390 new_acc: 0.198
2024-04-28 08:12:56,822 - evaluate - INFO - case 1 V1_all_acc: 0.293 V1_old_acc: 0.484 V1_new_acc: 0.213
2024-04-28 08:12:58,166 - evaluate - INFO - test len(list(set(preds1))): 409 len(preds): 5098
2024-04-28 08:12:58,166 - evaluate - INFO - case 2 all_acc: 0.254 old_acc: 0.390 new_acc: 0.198
2024-04-28 08:12:58,172 - evaluate - INFO - case 2 V1_all_acc: 0.293 V1_old_acc: 0.484 V1_new_acc: 0.213
2024-04-28 08:12:58,174 - main - INFO - Averaged stats:
2024-04-28 08:12:58,174 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 3.5476154883702598, 'loss_centers': 2.7448883652687073, 'loss_diff': 0.023679554074381787, 'loss_quan': 0.31689453125, 'loss_quan2': 0.5768636067708334}
2024-04-28 08:12:58,175 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:13:04,830 - log_every - INFO - Epoch: [5]  [ 0/12]  eta: 0:01:19  lr: 0.000100  loss_protop: 3.5213 (3.5213)  loss_centers: 2.7310 (2.7310)  loss_diff: 0.0093 (0.0093)  loss_quan: 0.3257 (0.3257)  loss_quan2: 0.5811 (0.5811)  time: 6.6539  data: 6.4640  max mem: 3301
2024-04-28 08:13:07,111 - log_every - INFO - Epoch: [5]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.4950 (3.4969)  loss_centers: 2.7244 (2.7261)  loss_diff: 0.0107 (0.0121)  loss_quan: 0.3164 (0.3177)  loss_quan2: 0.5903 (0.5886)  time: 0.7445  data: 0.5737  max mem: 3301
2024-04-28 08:13:07,409 - log_every - INFO - Epoch: [5] Total time: 0:00:09 (0.7695 s / it)
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 0: 1
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 1: 6
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 2: 18
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 3: 47
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 4: 101
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 5: 146
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 6: 147
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 7: 146
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 8: 83
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 9: 32
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 10: 13
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 11: 1
2024-04-28 08:13:07,443 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:13:07,443 - evaluate - INFO - Start validation
2024-04-28 08:13:17,491 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:40  acc1_protop: 30.7292 (30.7292)  local_acc1: 30.7292 (30.7292)  time: 10.0461  data: 9.8520  max mem: 3301
2024-04-28 08:13:22,104 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 52.6042 (60.4167)  local_acc1: 52.6042 (60.4167)  time: 1.3325  data: 1.1378  max mem: 3301
2024-04-28 08:13:22,992 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 33.8542 (48.9447)  local_acc1: 33.8542 (48.9447)  time: 0.9715  data: 0.7823  max mem: 3301
2024-04-28 08:13:23,390 - log_every - INFO - Test: Total time: 0:00:15 (0.9966 s / it)
2024-04-28 08:13:23,453 - evaluate - INFO - len(list(set(preds))): 470 len(preds): 2985
2024-04-28 08:13:23,453 - evaluate - INFO - hash Acc: 0.367
2024-04-28 08:13:23,453 - evaluate - INFO - * Acc1_protop 48.945
2024-04-28 08:13:51,735 - evaluate - INFO - test len(list(set(preds))): 1028 len(preds): 5098
2024-04-28 08:13:51,735 - evaluate - INFO - test hash all_acc: 0.199 old_acc: 0.284 new_acc: 0.163
2024-04-28 08:13:53,067 - evaluate - INFO - test len(list(set(preds1))): 407 len(preds): 5098
2024-04-28 08:13:53,068 - evaluate - INFO - case 1 all_acc: 0.271 old_acc: 0.394 new_acc: 0.220
2024-04-28 08:13:53,075 - evaluate - INFO - case 1 V1_all_acc: 0.307 V1_old_acc: 0.470 V1_new_acc: 0.240
2024-04-28 08:13:54,415 - evaluate - INFO - test len(list(set(preds1))): 407 len(preds): 5098
2024-04-28 08:13:54,416 - evaluate - INFO - case 2 all_acc: 0.271 old_acc: 0.394 new_acc: 0.220
2024-04-28 08:13:54,423 - evaluate - INFO - case 2 V1_all_acc: 0.307 V1_old_acc: 0.470 V1_new_acc: 0.240
2024-04-28 08:13:54,425 - main - INFO - Averaged stats:
2024-04-28 08:13:54,425 - main - INFO - {'lr': 0.00010000000000000003, 'loss_protop': 3.4968923926353455, 'loss_centers': 2.726126710573832, 'loss_diff': 0.012069311070566377, 'loss_quan': 0.31768798828125, 'loss_quan2': 0.5885823567708334}
2024-04-28 08:13:54,426 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:14:00,676 - log_every - INFO - Epoch: [6]  [ 0/12]  eta: 0:01:14  lr: 0.000100  loss_protop: 3.4651 (3.4651)  loss_centers: 2.7040 (2.7040)  loss_diff: 0.0064 (0.0064)  loss_quan: 0.3152 (0.3152)  loss_quan2: 0.5879 (0.5879)  time: 6.2491  data: 6.0474  max mem: 3301
2024-04-28 08:14:02,935 - log_every - INFO - Epoch: [6]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.4388 (3.4427)  loss_centers: 2.7083 (2.7095)  loss_diff: 0.0181 (0.0170)  loss_quan: 0.3215 (0.3223)  loss_quan2: 0.5869 (0.5857)  time: 0.7089  data: 0.5392  max mem: 3301
2024-04-28 08:14:03,282 - log_every - INFO - Epoch: [6] Total time: 0:00:08 (0.7380 s / it)
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 0: 2
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 1: 6
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 2: 17
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 3: 49
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 4: 107
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 5: 155
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 6: 143
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 7: 131
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 8: 80
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 9: 39
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 10: 12
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 11: 0
2024-04-28 08:14:03,327 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:14:03,328 - evaluate - INFO - Start validation
2024-04-28 08:14:12,784 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:31  acc1_protop: 36.4583 (36.4583)  local_acc1: 36.4583 (36.4583)  time: 9.4548  data: 9.2605  max mem: 3301
2024-04-28 08:14:17,675 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 59.8958 (63.7784)  local_acc1: 59.8958 (63.7784)  time: 1.3040  data: 1.1093  max mem: 3301
2024-04-28 08:14:18,825 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 40.1042 (52.5628)  local_acc1: 40.1042 (52.5628)  time: 0.9683  data: 0.7791  max mem: 3301
2024-04-28 08:14:19,258 - log_every - INFO - Test: Total time: 0:00:15 (0.9956 s / it)
2024-04-28 08:14:19,310 - evaluate - INFO - len(list(set(preds))): 434 len(preds): 2985
2024-04-28 08:14:19,311 - evaluate - INFO - hash Acc: 0.466
2024-04-28 08:14:19,311 - evaluate - INFO - * Acc1_protop 52.563
2024-04-28 08:14:45,266 - evaluate - INFO - test len(list(set(preds))): 968 len(preds): 5098
2024-04-28 08:14:45,266 - evaluate - INFO - test hash all_acc: 0.231 old_acc: 0.378 new_acc: 0.171
2024-04-28 08:14:46,397 - evaluate - INFO - test len(list(set(preds1))): 344 len(preds): 5098
2024-04-28 08:14:46,398 - evaluate - INFO - case 1 all_acc: 0.292 old_acc: 0.429 new_acc: 0.235
2024-04-28 08:14:46,404 - evaluate - INFO - case 1 V1_all_acc: 0.336 V1_old_acc: 0.510 V1_new_acc: 0.264
2024-04-28 08:14:47,517 - evaluate - INFO - test len(list(set(preds1))): 344 len(preds): 5098
2024-04-28 08:14:47,518 - evaluate - INFO - case 2 all_acc: 0.292 old_acc: 0.429 new_acc: 0.235
2024-04-28 08:14:47,523 - evaluate - INFO - case 2 V1_all_acc: 0.336 V1_old_acc: 0.510 V1_new_acc: 0.264
2024-04-28 08:14:47,525 - main - INFO - Averaged stats:
2024-04-28 08:14:47,525 - main - INFO - {'lr': 9.986128001799077e-05, 'loss_protop': 3.44273978471756, 'loss_centers': 2.709528843561808, 'loss_diff': 0.016993856988847256, 'loss_quan': 0.32232666015625, 'loss_quan2': 0.5856526692708334}
2024-04-28 08:14:47,526 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:14:53,704 - log_every - INFO - Epoch: [7]  [ 0/12]  eta: 0:01:14  lr: 0.000100  loss_protop: 3.4047 (3.4047)  loss_centers: 2.6999 (2.6999)  loss_diff: 0.0296 (0.0296)  loss_quan: 0.3193 (0.3193)  loss_quan2: 0.5693 (0.5693)  time: 6.1756  data: 5.9699  max mem: 3301
2024-04-28 08:14:55,864 - log_every - INFO - Epoch: [7]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.3702 (3.3763)  loss_centers: 2.7028 (2.7030)  loss_diff: 0.0056 (0.0084)  loss_quan: 0.3171 (0.3157)  loss_quan2: 0.5762 (0.5745)  time: 0.6917  data: 0.5178  max mem: 3301
2024-04-28 08:14:56,228 - log_every - INFO - Epoch: [7] Total time: 0:00:08 (0.7252 s / it)
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 0: 6
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 1: 7
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 2: 15
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 3: 37
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 4: 103
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 5: 154
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 6: 151
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 7: 132
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 8: 93
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 9: 30
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 10: 13
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 11: 0
2024-04-28 08:14:56,272 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:14:56,273 - evaluate - INFO - Start validation
2024-04-28 08:15:05,056 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:20  acc1_protop: 45.8333 (45.8333)  local_acc1: 45.8333 (45.8333)  time: 8.7816  data: 8.5797  max mem: 3301
2024-04-28 08:15:10,279 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 64.5833 (68.2765)  local_acc1: 64.5833 (68.2765)  time: 1.2722  data: 1.0739  max mem: 3301
2024-04-28 08:15:11,647 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 46.8750 (57.7554)  local_acc1: 46.8750 (57.7554)  time: 0.9601  data: 0.7684  max mem: 3301
2024-04-28 08:15:11,994 - log_every - INFO - Test: Total time: 0:00:15 (0.9825 s / it)
2024-04-28 08:15:12,057 - evaluate - INFO - len(list(set(preds))): 400 len(preds): 2985
2024-04-28 08:15:12,057 - evaluate - INFO - hash Acc: 0.507
2024-04-28 08:15:12,057 - evaluate - INFO - * Acc1_protop 57.755
2024-04-28 08:15:37,988 - evaluate - INFO - test len(list(set(preds))): 1022 len(preds): 5098
2024-04-28 08:15:37,988 - evaluate - INFO - test hash all_acc: 0.229 old_acc: 0.355 new_acc: 0.177
2024-04-28 08:15:39,182 - evaluate - INFO - test len(list(set(preds1))): 368 len(preds): 5098
2024-04-28 08:15:39,182 - evaluate - INFO - case 1 all_acc: 0.288 old_acc: 0.428 new_acc: 0.230
2024-04-28 08:15:39,188 - evaluate - INFO - case 1 V1_all_acc: 0.343 V1_old_acc: 0.541 V1_new_acc: 0.261
2024-04-28 08:15:40,382 - evaluate - INFO - test len(list(set(preds1))): 368 len(preds): 5098
2024-04-28 08:15:40,382 - evaluate - INFO - case 2 all_acc: 0.288 old_acc: 0.428 new_acc: 0.230
2024-04-28 08:15:40,388 - evaluate - INFO - case 2 V1_all_acc: 0.343 V1_old_acc: 0.541 V1_new_acc: 0.261
2024-04-28 08:15:40,390 - main - INFO - Averaged stats:
2024-04-28 08:15:40,390 - main - INFO - {'lr': 9.98002884071386e-05, 'loss_protop': 3.376345992088318, 'loss_centers': 2.702974538008372, 'loss_diff': 0.008371728152269498, 'loss_quan': 0.315673828125, 'loss_quan2': 0.5745442708333334}
2024-04-28 08:15:40,391 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:15:46,201 - log_every - INFO - Epoch: [8]  [ 0/12]  eta: 0:01:09  lr: 0.000100  loss_protop: 3.3291 (3.3291)  loss_centers: 2.6934 (2.6934)  loss_diff: 0.0062 (0.0062)  loss_quan: 0.3047 (0.3047)  loss_quan2: 0.5596 (0.5596)  time: 5.8093  data: 5.5783  max mem: 3301
2024-04-28 08:15:49,047 - log_every - INFO - Epoch: [8]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.3036 (3.3048)  loss_centers: 2.6934 (2.6943)  loss_diff: 0.0061 (0.0078)  loss_quan: 0.3047 (0.3050)  loss_quan2: 0.5596 (0.5589)  time: 0.7211  data: 0.5446  max mem: 3301
2024-04-28 08:15:49,358 - log_every - INFO - Epoch: [8] Total time: 0:00:08 (0.7473 s / it)
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 0: 0
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 1: 5
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 2: 13
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 3: 48
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 4: 100
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 5: 157
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 6: 156
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 7: 125
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 8: 92
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 9: 39
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 10: 6
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 11: 0
2024-04-28 08:15:49,403 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:15:49,403 - evaluate - INFO - Start validation
2024-04-28 08:15:59,891 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:47  acc1_protop: 52.6042 (52.6042)  local_acc1: 52.6042 (52.6042)  time: 10.4855  data: 10.2917  max mem: 3301
2024-04-28 08:16:04,368 - log_every - INFO - Test:  [10/16]  eta: 0:00:08  acc1_protop: 66.6667 (70.1231)  local_acc1: 66.6667 (70.1231)  time: 1.3601  data: 1.1640  max mem: 3301
2024-04-28 08:16:05,257 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 52.6042 (60.1675)  local_acc1: 52.6042 (60.1675)  time: 0.9906  data: 0.8003  max mem: 3301
2024-04-28 08:16:05,585 - log_every - INFO - Test: Total time: 0:00:16 (1.0113 s / it)
2024-04-28 08:16:05,648 - evaluate - INFO - len(list(set(preds))): 398 len(preds): 2985
2024-04-28 08:16:05,648 - evaluate - INFO - hash Acc: 0.507
2024-04-28 08:16:05,648 - evaluate - INFO - * Acc1_protop 60.168
2024-04-28 08:16:32,782 - evaluate - INFO - test len(list(set(preds))): 1003 len(preds): 5098
2024-04-28 08:16:32,782 - evaluate - INFO - test hash all_acc: 0.265 old_acc: 0.345 new_acc: 0.232
2024-04-28 08:16:33,943 - evaluate - INFO - test len(list(set(preds1))): 370 len(preds): 5098
2024-04-28 08:16:33,944 - evaluate - INFO - case 1 all_acc: 0.313 old_acc: 0.427 new_acc: 0.265
2024-04-28 08:16:33,949 - evaluate - INFO - case 1 V1_all_acc: 0.362 V1_old_acc: 0.553 V1_new_acc: 0.283
2024-04-28 08:16:35,113 - evaluate - INFO - test len(list(set(preds1))): 370 len(preds): 5098
2024-04-28 08:16:35,113 - evaluate - INFO - case 2 all_acc: 0.313 old_acc: 0.427 new_acc: 0.265
2024-04-28 08:16:35,119 - evaluate - INFO - case 2 V1_all_acc: 0.362 V1_old_acc: 0.553 V1_new_acc: 0.283
2024-04-28 08:16:35,120 - main - INFO - Averaged stats:
2024-04-28 08:16:35,120 - main - INFO - {'lr': 9.97282429954831e-05, 'loss_protop': 3.3047500451405845, 'loss_centers': 2.6942893664042153, 'loss_diff': 0.007837540086863251, 'loss_quan': 0.3050333658854167, 'loss_quan2': 0.5589192708333334}
2024-04-28 08:16:35,121 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:16:41,148 - log_every - INFO - Epoch: [9]  [ 0/12]  eta: 0:01:12  lr: 0.000100  loss_protop: 3.2484 (3.2484)  loss_centers: 2.6822 (2.6822)  loss_diff: 0.0065 (0.0065)  loss_quan: 0.3025 (0.3025)  loss_quan2: 0.5405 (0.5405)  time: 6.0253  data: 5.8177  max mem: 3301
2024-04-28 08:16:43,483 - log_every - INFO - Epoch: [9]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.2193 (3.2226)  loss_centers: 2.6909 (2.6932)  loss_diff: 0.0065 (0.0073)  loss_quan: 0.2876 (0.2887)  loss_quan2: 0.5430 (0.5443)  time: 0.6966  data: 0.5237  max mem: 3301
2024-04-28 08:16:43,862 - log_every - INFO - Epoch: [9] Total time: 0:00:08 (0.7284 s / it)
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 0: 6
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 1: 1
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 2: 18
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 3: 36
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 4: 102
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 5: 174
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 6: 124
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 7: 134
2024-04-28 08:16:43,907 - hamming_distance_statistics - INFO - Hamming distance 8: 107
2024-04-28 08:16:43,908 - hamming_distance_statistics - INFO - Hamming distance 9: 28
2024-04-28 08:16:43,908 - hamming_distance_statistics - INFO - Hamming distance 10: 6
2024-04-28 08:16:43,908 - hamming_distance_statistics - INFO - Hamming distance 11: 5
2024-04-28 08:16:43,908 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:16:43,908 - evaluate - INFO - Start validation
2024-04-28 08:16:52,707 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:20  acc1_protop: 58.3333 (58.3333)  local_acc1: 58.3333 (58.3333)  time: 8.7974  data: 8.6015  max mem: 3301
2024-04-28 08:16:58,083 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 68.2292 (72.6326)  local_acc1: 68.2292 (72.6326)  time: 1.2883  data: 1.0931  max mem: 3301
2024-04-28 08:17:00,345 - log_every - INFO - Test:  [15/16]  eta: 0:00:01  acc1_protop: 51.0417 (63.5846)  local_acc1: 51.0417 (63.5846)  time: 1.0271  data: 0.8375  max mem: 3301
2024-04-28 08:17:00,821 - log_every - INFO - Test: Total time: 0:00:16 (1.0570 s / it)
2024-04-28 08:17:00,883 - evaluate - INFO - len(list(set(preds))): 369 len(preds): 2985
2024-04-28 08:17:00,883 - evaluate - INFO - hash Acc: 0.619
2024-04-28 08:17:00,883 - evaluate - INFO - * Acc1_protop 63.585
2024-04-28 08:17:27,656 - evaluate - INFO - test len(list(set(preds))): 894 len(preds): 5098
2024-04-28 08:17:27,656 - evaluate - INFO - test hash all_acc: 0.266 old_acc: 0.429 new_acc: 0.198
2024-04-28 08:17:28,806 - evaluate - INFO - test len(list(set(preds1))): 349 len(preds): 5098
2024-04-28 08:17:28,806 - evaluate - INFO - case 1 all_acc: 0.314 old_acc: 0.485 new_acc: 0.243
2024-04-28 08:17:28,812 - evaluate - INFO - case 1 V1_all_acc: 0.375 V1_old_acc: 0.604 V1_new_acc: 0.280
2024-04-28 08:17:29,966 - evaluate - INFO - test len(list(set(preds1))): 349 len(preds): 5098
2024-04-28 08:17:29,966 - evaluate - INFO - case 2 all_acc: 0.314 old_acc: 0.485 new_acc: 0.243
2024-04-28 08:17:29,971 - evaluate - INFO - case 2 V1_all_acc: 0.375 V1_old_acc: 0.604 V1_new_acc: 0.280
2024-04-28 08:17:29,973 - main - INFO - Averaged stats:
2024-04-28 08:17:29,973 - main - INFO - {'lr': 9.964516155915147e-05, 'loss_protop': 3.2226105332374573, 'loss_centers': 2.6932162841161094, 'loss_diff': 0.007303352118469775, 'loss_quan': 0.2886555989583333, 'loss_quan2': 0.5443115234375}
2024-04-28 08:17:29,974 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:17:36,958 - log_every - INFO - Epoch: [10]  [ 0/12]  eta: 0:01:23  lr: 0.000100  loss_protop: 3.1732 (3.1732)  loss_centers: 2.6680 (2.6680)  loss_diff: 0.0085 (0.0085)  loss_quan: 0.2791 (0.2791)  loss_quan2: 0.5439 (0.5439)  time: 6.9834  data: 6.8047  max mem: 3301
2024-04-28 08:17:39,225 - log_every - INFO - Epoch: [10]  [11/12]  eta: 0:00:00  lr: 0.000100  loss_protop: 3.1325 (3.1272)  loss_centers: 2.6853 (2.6862)  loss_diff: 0.0085 (0.0093)  loss_quan: 0.2883 (0.2874)  loss_quan2: 0.5400 (0.5385)  time: 0.7708  data: 0.5986  max mem: 3301
2024-04-28 08:17:39,599 - log_every - INFO - Epoch: [10] Total time: 0:00:09 (0.8021 s / it)
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 0: 0
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 1: 4
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 2: 18
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 3: 49
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 4: 97
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 5: 149
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 6: 154
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 7: 133
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 8: 83
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 9: 43
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 10: 9
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 11: 2
2024-04-28 08:17:39,643 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:17:39,644 - evaluate - INFO - Start validation
2024-04-28 08:17:47,999 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:13  acc1_protop: 66.6667 (66.6667)  local_acc1: 66.6667 (66.6667)  time: 8.3541  data: 8.1601  max mem: 3301
2024-04-28 08:17:53,563 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 69.2708 (75.8523)  local_acc1: 69.2708 (75.8523)  time: 1.2647  data: 1.0659  max mem: 3301
2024-04-28 08:17:55,321 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 58.3333 (67.8392)  local_acc1: 58.3333 (67.8392)  time: 0.9793  data: 0.7873  max mem: 3301
2024-04-28 08:17:55,635 - log_every - INFO - Test: Total time: 0:00:15 (0.9994 s / it)
2024-04-28 08:17:55,701 - evaluate - INFO - len(list(set(preds))): 361 len(preds): 2985
2024-04-28 08:17:55,701 - evaluate - INFO - hash Acc: 0.601
2024-04-28 08:17:55,701 - evaluate - INFO - * Acc1_protop 67.839
2024-04-28 08:18:22,608 - evaluate - INFO - test len(list(set(preds))): 1001 len(preds): 5098
2024-04-28 08:18:22,608 - evaluate - INFO - test hash all_acc: 0.269 old_acc: 0.394 new_acc: 0.218
2024-04-28 08:18:23,869 - evaluate - INFO - test len(list(set(preds1))): 376 len(preds): 5098
2024-04-28 08:18:23,869 - evaluate - INFO - case 1 all_acc: 0.304 old_acc: 0.462 new_acc: 0.238
2024-04-28 08:18:23,876 - evaluate - INFO - case 1 V1_all_acc: 0.351 V1_old_acc: 0.557 V1_new_acc: 0.266
2024-04-28 08:18:25,156 - evaluate - INFO - test len(list(set(preds1))): 376 len(preds): 5098
2024-04-28 08:18:25,156 - evaluate - INFO - case 2 all_acc: 0.304 old_acc: 0.462 new_acc: 0.238
2024-04-28 08:18:25,162 - evaluate - INFO - case 2 V1_all_acc: 0.351 V1_old_acc: 0.557 V1_new_acc: 0.266
2024-04-28 08:18:25,163 - main - INFO - Averaged stats:
2024-04-28 08:18:25,164 - main - INFO - {'lr': 9.95510645972451e-05, 'loss_protop': 3.127206484476725, 'loss_centers': 2.6861890157063804, 'loss_diff': 0.009256477216088873, 'loss_quan': 0.287353515625, 'loss_quan2': 0.5384521484375}
2024-04-28 08:18:25,165 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:18:31,646 - log_every - INFO - Epoch: [11]  [ 0/12]  eta: 0:01:17  lr: 0.000099  loss_protop: 3.1012 (3.1012)  loss_centers: 2.6972 (2.6972)  loss_diff: 0.0115 (0.0115)  loss_quan: 0.2849 (0.2849)  loss_quan2: 0.5122 (0.5122)  time: 6.4799  data: 6.3023  max mem: 3301
2024-04-28 08:18:34,134 - log_every - INFO - Epoch: [11]  [11/12]  eta: 0:00:00  lr: 0.000099  loss_protop: 2.9930 (3.0166)  loss_centers: 2.6851 (2.6844)  loss_diff: 0.0060 (0.0066)  loss_quan: 0.2781 (0.2789)  loss_quan2: 0.5264 (0.5308)  time: 0.7472  data: 0.5764  max mem: 3301
2024-04-28 08:18:34,474 - log_every - INFO - Epoch: [11] Total time: 0:00:09 (0.7758 s / it)
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 0: 1
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 1: 5
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 2: 20
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 3: 37
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 4: 90
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 5: 171
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 6: 147
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 7: 125
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 8: 95
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 9: 39
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 10: 8
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 11: 3
2024-04-28 08:18:34,513 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:18:34,514 - evaluate - INFO - Start validation
2024-04-28 08:18:43,966 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:31  acc1_protop: 80.2083 (80.2083)  local_acc1: 80.2083 (80.2083)  time: 9.4505  data: 9.2571  max mem: 3301
2024-04-28 08:18:49,372 - log_every - INFO - Test:  [10/16]  eta: 0:00:08  acc1_protop: 80.2083 (77.8409)  local_acc1: 80.2083 (77.8409)  time: 1.3505  data: 1.1543  max mem: 3301
2024-04-28 08:18:50,261 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 59.3750 (69.4472)  local_acc1: 59.3750 (69.4472)  time: 0.9840  data: 0.7936  max mem: 3301
2024-04-28 08:18:50,643 - log_every - INFO - Test: Total time: 0:00:16 (1.0080 s / it)
2024-04-28 08:18:50,693 - evaluate - INFO - len(list(set(preds))): 321 len(preds): 2985
2024-04-28 08:18:50,693 - evaluate - INFO - hash Acc: 0.619
2024-04-28 08:18:50,694 - evaluate - INFO - * Acc1_protop 69.447
2024-04-28 08:19:17,473 - evaluate - INFO - test len(list(set(preds))): 913 len(preds): 5098
2024-04-28 08:19:17,473 - evaluate - INFO - test hash all_acc: 0.292 old_acc: 0.429 new_acc: 0.235
2024-04-28 08:19:18,360 - evaluate - INFO - test len(list(set(preds1))): 344 len(preds): 5098
2024-04-28 08:19:18,360 - evaluate - INFO - case 1 all_acc: 0.340 old_acc: 0.494 new_acc: 0.277
2024-04-28 08:19:18,366 - evaluate - INFO - case 1 V1_all_acc: 0.408 V1_old_acc: 0.616 V1_new_acc: 0.322
2024-04-28 08:19:19,225 - evaluate - INFO - test len(list(set(preds1))): 344 len(preds): 5098
2024-04-28 08:19:19,226 - evaluate - INFO - case 2 all_acc: 0.340 old_acc: 0.494 new_acc: 0.277
2024-04-28 08:19:19,231 - evaluate - INFO - case 2 V1_all_acc: 0.408 V1_old_acc: 0.616 V1_new_acc: 0.322
2024-04-28 08:19:19,233 - main - INFO - Averaged stats:
2024-04-28 08:19:19,233 - main - INFO - {'lr': 9.944597532678122e-05, 'loss_protop': 3.016569753487905, 'loss_centers': 2.684430499871572, 'loss_diff': 0.006635617100982927, 'loss_quan': 0.27886962890625, 'loss_quan2': 0.53076171875}
2024-04-28 08:19:19,234 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:19:25,329 - log_every - INFO - Epoch: [12]  [ 0/12]  eta: 0:01:13  lr: 0.000099  loss_protop: 2.9864 (2.9864)  loss_centers: 2.6945 (2.6945)  loss_diff: 0.0043 (0.0043)  loss_quan: 0.2825 (0.2825)  loss_quan2: 0.5146 (0.5146)  time: 6.0932  data: 5.8765  max mem: 3301
2024-04-28 08:19:27,784 - log_every - INFO - Epoch: [12]  [11/12]  eta: 0:00:00  lr: 0.000099  loss_protop: 2.9023 (2.8958)  loss_centers: 2.6822 (2.6824)  loss_diff: 0.0052 (0.0062)  loss_quan: 0.2708 (0.2727)  loss_quan2: 0.5146 (0.5159)  time: 0.7122  data: 0.5419  max mem: 3301
2024-04-28 08:19:28,220 - log_every - INFO - Epoch: [12] Total time: 0:00:08 (0.7488 s / it)
2024-04-28 08:19:28,255 - hamming_distance_statistics - INFO - Hamming distance 0: 1
2024-04-28 08:19:28,255 - hamming_distance_statistics - INFO - Hamming distance 1: 8
2024-04-28 08:19:28,255 - hamming_distance_statistics - INFO - Hamming distance 2: 21
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 3: 41
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 4: 93
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 5: 156
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 6: 154
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 7: 128
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 8: 82
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 9: 43
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 10: 12
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 11: 2
2024-04-28 08:19:28,256 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:19:28,256 - evaluate - INFO - Start validation
2024-04-28 08:19:37,002 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:19  acc1_protop: 84.8958 (84.8958)  local_acc1: 84.8958 (84.8958)  time: 8.7440  data: 8.4905  max mem: 3301
2024-04-28 08:19:42,191 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 84.8958 (79.5928)  local_acc1: 84.8958 (79.5928)  time: 1.2664  data: 1.0650  max mem: 3301
2024-04-28 08:19:43,821 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 67.7083 (73.4003)  local_acc1: 67.7083 (73.4003)  time: 0.9725  data: 0.7785  max mem: 3301
2024-04-28 08:19:44,176 - log_every - INFO - Test: Total time: 0:00:15 (0.9949 s / it)
2024-04-28 08:19:44,232 - evaluate - INFO - len(list(set(preds))): 339 len(preds): 2985
2024-04-28 08:19:44,232 - evaluate - INFO - hash Acc: 0.651
2024-04-28 08:19:44,232 - evaluate - INFO - * Acc1_protop 73.400
2024-04-28 08:20:11,094 - evaluate - INFO - test len(list(set(preds))): 867 len(preds): 5098
2024-04-28 08:20:11,094 - evaluate - INFO - test hash all_acc: 0.292 old_acc: 0.433 new_acc: 0.234
2024-04-28 08:20:12,008 - evaluate - INFO - test len(list(set(preds1))): 344 len(preds): 5098
2024-04-28 08:20:12,008 - evaluate - INFO - case 1 all_acc: 0.340 old_acc: 0.522 new_acc: 0.264
2024-04-28 08:20:12,014 - evaluate - INFO - case 1 V1_all_acc: 0.400 V1_old_acc: 0.644 V1_new_acc: 0.299
2024-04-28 08:20:12,962 - evaluate - INFO - test len(list(set(preds1))): 344 len(preds): 5098
2024-04-28 08:20:12,962 - evaluate - INFO - case 2 all_acc: 0.340 old_acc: 0.522 new_acc: 0.264
2024-04-28 08:20:12,968 - evaluate - INFO - case 2 V1_all_acc: 0.400 V1_old_acc: 0.644 V1_new_acc: 0.299
2024-04-28 08:20:12,971 - main - INFO - Averaged stats:
2024-04-28 08:20:12,971 - main - INFO - {'lr': 9.93299196769648e-05, 'loss_protop': 2.895812968413035, 'loss_centers': 2.6823612451553345, 'loss_diff': 0.006243322806161207, 'loss_quan': 0.272705078125, 'loss_quan2': 0.515869140625}
2024-04-28 08:20:12,972 - train_one_epoch - INFO - Start train one epoch
2024-04-28 08:20:19,249 - log_every - INFO - Epoch: [13]  [ 0/12]  eta: 0:01:15  lr: 0.000099  loss_protop: 2.8793 (2.8793)  loss_centers: 2.6982 (2.6982)  loss_diff: 0.0198 (0.0198)  loss_quan: 0.2671 (0.2671)  loss_quan2: 0.5044 (0.5044)  time: 6.2748  data: 6.0302  max mem: 3301
2024-04-28 08:20:21,894 - log_every - INFO - Epoch: [13]  [11/12]  eta: 0:00:00  lr: 0.000099  loss_protop: 2.7756 (2.7530)  loss_centers: 2.6817 (2.6794)  loss_diff: 0.0042 (0.0055)  loss_quan: 0.2671 (0.2666)  loss_quan2: 0.5117 (0.5128)  time: 0.7431  data: 0.5709  max mem: 3301
2024-04-28 08:20:22,209 - log_every - INFO - Epoch: [13] Total time: 0:00:09 (0.7696 s / it)
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 0: 1
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 1: 6
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 2: 17
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 3: 44
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 4: 93
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 5: 149
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 6: 158
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 7: 132
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 8: 80
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 9: 48
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 10: 12
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 11: 1
2024-04-28 08:20:22,240 - hamming_distance_statistics - INFO - Hamming distance 12: 0
2024-04-28 08:20:22,240 - evaluate - INFO - Start validation
2024-04-28 08:20:31,881 - log_every - INFO - Test:  [ 0/16]  eta: 0:02:34  acc1_protop: 85.4167 (85.4167)  local_acc1: 85.4167 (85.4167)  time: 9.6384  data: 9.4446  max mem: 3301
2024-04-28 08:20:35,922 - log_every - INFO - Test:  [10/16]  eta: 0:00:07  acc1_protop: 85.4167 (81.2500)  local_acc1: 85.4167 (81.2500)  time: 1.2435  data: 1.0468  max mem: 3301
2024-04-28 08:20:37,626 - log_every - INFO - Test:  [15/16]  eta: 0:00:00  acc1_protop: 75.0000 (76.1139)  local_acc1: 75.0000 (76.1139)  time: 0.9613  data: 0.7708  max mem: 3301
2024-04-28 08:20:37,955 - log_every - INFO - Test: Total time: 0:00:15 (0.9821 s / it)
2024-04-28 08:20:37,999 - evaluate - INFO - len(list(set(preds))): 340 len(preds): 2985
2024-04-28 08:20:37,999 - evaluate - INFO - hash Acc: 0.659
2024-04-28 08:20:37,999 - evaluate - INFO - * Acc1_protop 76.114
